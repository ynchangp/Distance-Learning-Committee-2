<h3>검색 결과</h3>
<table border="1">
  <tr>
    <th>Name</th><th>Year Semester</th><th>Language</th><th>Course Title</th>
    <th>Time Slot</th><th>Day</th><th>Time</th><th>Frequency</th>
    <th>Course format</th><th>Reason for Applying</th><th>Modified</th>
    <th>Apply</th>
  </tr>
  {% for cm in items %}
  <tr>
    <td>{{cm.name}}</td><td>{{cm.year_semester}}</td><td>{{cm.language}}</td><td>{{cm.course_title}}</td>
    <td>{{cm.time_slot}}</td><td>{{cm.day}}</td><td>{{cm.time}}</td><td>{{cm.frequency}}</td>
    <td>{{cm.course_format}}</td><td>{{cm.reason_for_applying}}</td><td>{{cm.modified}}</td>
    <td>
      <input type="password" maxlength="4" id="pwd{{cm.id}}" placeholder="4자리">
      {% if cm.apply_this_semester %}
        <button onclick="delApply({{cm.id}})">Delete</button>
        <span>현재: YES</span>
      {% else %}
        <button onclick="apply({{cm.id}})">Apply this semester</button>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

<script>
async function apply(id){
  const pwd = document.getElementById('pwd'+id).value;
  await fetch('/course/apply/', {
    method:'POST',
    headers:{'X-CSRFToken':'{{csrf_token}}','Content-Type':'application/x-www-form-urlencoded'},
    body:`id=${id}&password=${encodeURIComponent(pwd)}`
  });
  location.reload();
}
async function delApply(id){
  const pwd = document.getElementById('pwd'+id).value;
  await fetch('/course/delete/', {
    method:'POST',
    headers:{'X-CSRFToken':'{{csrf_token}}','Content-Type':'application/x-www-form-urlencoded'},
    body:`id=${id}&password=${encodeURIComponent(pwd)}`
  });
  location.reload();
}
</script>

